<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Winapp2 Entry Writing Helper</title>
</head>
<body>

<main>
	<div>
		Entry Name *
		<input type="text" class="entryName">
	</div>

	<div>
		Operating System Selection
		<select class="osMode" onchange="enableOS()">
			<option>None</option>
			<option>Strict</option>
			<option>Minimum</option>
			<option>Maximum</option>
		</select>
	</div>

	<div>
		Operating System
		<select class="osName" disabled>
			<option value="5.0">Windows 2000</option>
			<option value="5.1">Windows XP</option>
			<option value="5.2">Windows XP 64-Bit Edition, Windows Server 2003, Windows Home Server</option>
			<option value="6.0">Windows Vista, Windows Server 2008</option>
			<option value="6.1">Windows 7, Windows Server 2008 R2, Windows Home Server 2011</option>
			<option value="6.2">Windows 8, Windows Server 2012</option>
			<option value="6.3">Windows 8.1, Windows Server 2012 R2</option>
			<option value="10.0">Windows 10, Windows Server 2016, Windows Server 2019</option>
		</select>
	</div>

	<div>
		Section
		<select class="section">
			<option>None</option>
			<option value="3001">Internet Explorer</option>
			<option value="3005">Microsoft Edge</option>
			<option value="3006">Edge Chromium</option>
			<option value="3021" selected>Applications</option>
			<option value="3022">Internet</option>
			<option value="3023">Multimedia</option>
			<option value="3024">Utilities</option>
			<option value="3025">Windows</option>
			<option value="3026">Firefox</option>
			<option value="3027">Opera</option>
			<option value="3028">Safari</option>
			<option value="3029">Google Chrome</option>
			<option value="3030">Thunderbird</option>
			<option value="3031">Windows Store</option>
			<option value="3032">CCleaner Browser</option>
			<option value="3033">Vivaldi</option>
			<option value="3034">Brave</option>
		</select>
	</div>

	<div>
		Registry Entry Detection<br>
		<textarea class="registryDetect" cols="90" rows="5"></textarea>
	</div>

	<div>
		File / Folder Detection<br>
		<textarea class="fileFolderDetect" cols="90" rows="5"></textarea>
	</div>

	<button onclick="createEntry()">Create</button><br>

	<div>
		Final Entry<br>
		<textarea class="finalEntry" cols="90" rows="10"></textarea>
	</div>
</main>


<script>
	function createEntry()
	{
		// Get Entry Name
		let finalText = '[' + document.querySelector( '.entryName' ).value + ' *]';

		// Get OS Selection
		let osmode = document.querySelector( '.osMode' ).value;
		let osname = document.querySelector( '.osName' ).value;

		if ( osmode === 'Strict' )
		{
			finalText += '\nDetectOS=' + osname	+ '|' + osname;
		}
		else if ( osmode === 'Minimum' )
		{
			finalText += '\nDetectOS=' + osname	+ '|';
		}
		else if ( osmode === 'Maximum' )
		{
			finalText += '\nDetectOS=' + '|' + osname;
		}

		// Get Section Name
		if ( document.querySelector( '.section' ).value !== 'None' )
		{
			finalText += '\nLangSecRef=' + document.querySelector( '.section' ).value;
		}

		// Get Registry Entry Detection
		if ( document.querySelector( '.registryDetect' ).value !== '' )
		{
			// See if detect is multi-line
			let regDetectParts = document.querySelector( '.registryDetect' ).value.split( '\n' );
			if ( regDetectParts.length > 1 )
			{
				for( i in regDetectParts )
				{
					finalText += '\nDetect';
					finalText += parseInt( i ) + 1;
					finalText += '=' + regDetectParts[ i ];
				}
			}
			else
			{
				finalText += '\nDetect=' + regDetectParts;
			}
		}

		// File / Folder Detection
		if ( document.querySelector( '.fileFolderDetect' ).value !== '' )
		{
			// See if DetectFile is multi-line
			let fileFolderDetectParts = document.querySelector( '.fileFolderDetect' ).value.split( '\n' );
			if ( fileFolderDetectParts.length > 1 )
			{
				for( i in fileFolderDetectParts )
				{
					finalText += '\nDetectFile';
					finalText += parseInt( i ) + 1;
					finalText += '=' + fileFolderDetectParts[ i ];
				}
			}
			else
			{
				finalText += '\nDetectFile=' + fileFolderDetectParts;
			}
		}

		document.querySelector( '.finalEntry' ).innerHTML = finalText;
	} // createEntry()

	function enableOS()
	{
		if ( document.querySelector( '.osMode' ).value === 'None' )
		{
			document.querySelector( '.osName' ).setAttribute( 'disabled', 'disabled' );
		}
		else
		{
			document.querySelector( '.osName' ).removeAttribute( 'disabled' );
		}
	}
</script>

</body>
</html>
